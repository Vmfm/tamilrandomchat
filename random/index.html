<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TAMIL VM LIVE TV</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link href="https://unpkg.com/video.js/dist/video-js.css" rel="stylesheet">
<script src="https://unpkg.com/video.js/dist/video.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<style>
:root{
 --bg:#000;
 --text:#fff;
 --accent:#ff9800;
}
body{
 margin:0;
 background:var(--bg);
 color:var(--text);
 font-family:system-ui,-apple-system,Segoe UI,sans-serif;
 overflow:hidden;
}

/* FULLSCREEN VIDEO */
.video-js{
 width:100vw;
 height:100vh;
 object-fit:cover;
}

/* APK BUTTON */
.apk-btn{
 position:fixed;
 top:12px;
 left:12px;
 z-index:10000;
 background:#00e676;
 color:#000;
 padding:6px 14px;
 border-radius:20px;
 font-size:12px;
 font-weight:700;
 text-decoration:none;
 box-shadow:0 4px 12px rgba(0,0,0,.4);
}

/* THEME TOGGLE */
.toggle-btn{
 position:fixed;
 top:12px;
 right:12px;
 z-index:10000;
 background:var(--accent);
 border:none;
 color:#000;
 padding:6px 14px;
 border-radius:20px;
 font-size:12px;
 box-shadow:0 4px 12px rgba(0,0,0,.4);
}

/* LOADER */
#loader{
 position:fixed;
 inset:0;
 background:#000;
 display:flex;
 align-items:center;
 justify-content:center;
 z-index:99999;
}
#loader img{width:110px}
</style>
</head>
<body>

<div id="loader">
 <img src="https://vmfm.github.io/tamilvmtv/image/loading-loader.gif">
</div>

<a class="apk-btn" href="https://shareallfiles.net/P29GL8" target="_blank">‚¨á Android App</a>

<button class="toggle-btn" onclick="toggleTheme()">üåô / ‚òÄÔ∏è</button>

<video id="tvPlayer" class="video-js vjs-big-play-centered"
 autoplay playsinline webkit-playsinline muted
 preload="auto"
 data-setup='{"controls":false, "autoplay":true, "fluid":true}'>
</video>

<script>
const M3U_URL="https://vmfm.github.io/tamilvmtv/live/channels.m3u";
const player = videojs('tvPlayer', { 
 autoplay: true,
 controls: false,
 muted: true, // autoplay works on Android only if muted
 preload: 'auto',
 fluid: true,
 playsinline: true
});

let allChannels = [], views = JSON.parse(localStorage.getItem('views')||'{}');

if(localStorage.getItem('theme')==='light') document.body.classList.add('light');
function toggleTheme(){
 document.body.classList.toggle('light');
 localStorage.setItem('theme', document.body.classList.contains('light')?'light':'dark');
}

fetch(M3U_URL).then(r=>r.text()).then(d=>{
 d.split('\n').forEach((l,i,a)=>{
  if(l.startsWith('#EXTINF')){
   allChannels.push({
    name:l.split(',').pop().trim(),
    logo:(l.match(/tvg-logo="(.*?)"/)||[])[1]||'https://via.placeholder.com/300x200?text=TV',
    group:(l.match(/group-title="(.*?)"/)||[])[1]||'Other',
    url:a[i+1]?.trim()
   });
  }
 });
 // Play the first channel automatically
 if(allChannels[0]) player.src({src: allChannels[0].url, type: 'application/x-mpegURL'});
 $('#loader').hide();
});

// Optional: Switch channels by tapping anywhere (simplest Android-friendly UI)
document.body.addEventListener('click', () => {
 const next = allChannels[Math.floor(Math.random()*allChannels.length)];
 if(next) player.src({src: next.url, type: 'application/x-mpegURL'});
});
</script>

</body>
</html>
