<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Simple PeerJS Video Chat</title>
  <style>
    body { font-family: Arial; text-align: center; }
    video { width: 45%; margin: 10px; background: #000; }
    input, button { padding: 5px; margin: 5px; }
  </style>
</head>
<body>

  <h2>Simple PeerJS Video Chat</h2>

  <video id="my-video" autoplay muted playsinline></video>
  <video id="peer-video" autoplay playsinline></video>

  <p>Your ID: <span id="my-id">...</span></p>

  <input id="peer-id" placeholder="Enter peer ID" />
  <button onclick="connect()">Call</button>

  <script src="https://cdn.jsdelivr.net/npm/peerjs@1.4.7/dist/peerjs.min.js"></script>
  <script>
    const myVideo = document.getElementById('my-video');
    const peerVideo = document.getElementById('peer-video');
    const peerIdInput = document.getElementById('peer-id');
    const myIdDisplay = document.getElementById('my-id');

    let localStream;

    // 1. Get media
    navigator.mediaDevices.getUserMedia({ video: true, audio: true }).then(stream => {
      localStream = stream;
      myVideo.srcObject = stream;
    });

    // 2. Create peer connection (random ID)
    const peer = new Peer();

    peer.on('open', id => {
      myIdDisplay.textContent = id;
    });

    // 3. When someone calls you
    peer.on('call', call => {
      call.answer(localStream);
      call.on('stream', remoteStream => {
        peerVideo.srcObject = remoteStream;
      });
    });

    // 4. Connect to another peer
    function connect() {
      const otherPeerId = peerIdInput.value;
      const call = peer.call(otherPeerId, localStream);
      call.on('stream', remoteStream => {
        peerVideo.srcObject = remoteStream;
      });
    }
  </script>

</body>
</html>
