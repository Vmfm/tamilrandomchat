<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Random Video Chat</title>
<script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
<style>
body { font-family: Arial; text-align:center; background:#111; color:#fff; }
video { width:45%; margin:5px; border:2px solid #444; border-radius:10px; background:#000; }
button, input { padding:8px 12px; margin:5px; border-radius:6px; font-size:14px; }
</style>
</head>
<body>
<h2>Random Video Chat (Manual ID)</h2>
<input id="peerIdInput" placeholder="Enter partner ID">
<br>
<button onclick="init()">Start Local Video</button>
<button onclick="callPeer()">Call Partner</button>
<button onclick="endCall()">End Call</button>
<br>
<video id="localVideo" autoplay muted playsinline></video>
<video id="remoteVideo" autoplay playsinline></video>

<script>
let localStream, call;
let peer = new Peer(); // PeerJS cloud gives random ID
peer.on('open', id => { alert('Your ID: ' + id); });

navigator.mediaDevices.getUserMedia({ video:true, audio:true }).then(stream=>{
  localStream = stream;
  document.getElementById('localVideo').srcObject = stream;
});

peer.on('call', incomingCall=>{
  incomingCall.answer(localStream);
  incomingCall.on('stream', stream=>{
    document.getElementById('remoteVideo').srcObject = stream;
  });
});

function init() {
  // just ensures local video is shown
  if(localStream) document.getElementById('localVideo').srcObject = localStream;
}

function callPeer() {
  const partnerId = document.getElementById('peerIdInput').value;
  if(partnerId && localStream) {
    call = peer.call(partnerId, localStream);
    call.on('stream', stream=>{
      document.getElementById('remoteVideo').srcObject = stream;
    });
  } else {
    alert('Enter partner ID!');
  }
}

function endCall() {
  if(call) call.close();
  document.getElementById('remoteVideo').srcObject = null;
}
</script>
</body>
</html>
