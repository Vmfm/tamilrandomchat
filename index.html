<!DOCTYPE html>
<html>
<head>
  <title>PeerJS Video Chat</title>
  <style>
    video {
      width: 45%;
      margin: 5px;
      border: 2px solid #333;
    }
  </style>
</head>
<body>
  <h2>Simple Video Chat (PeerJS)</h2>

  <p>Your ID: <span id="my-id">...</span></p>
  <input id="peer-id-input" placeholder="Enter Peer ID to connect" />
  <button onclick="startCall()">Call</button>

  <br><br>
  <video id="local-video" autoplay muted></video>
  <video id="remote-video" autoplay></video>

  <!-- PeerJS CDN -->
  <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
  <script>
    const localVideo = document.getElementById("local-video");
    const remoteVideo = document.getElementById("remote-video");
    const peerIdInput = document.getElementById("peer-id-input");

    let localStream;
    const peer = new Peer(); // Uses free peerjs public server

    peer.on("open", (id) => {
      document.getElementById("my-id").textContent = id;
    });

    // Get media
    navigator.mediaDevices.getUserMedia({ video: true, audio: true })
      .then((stream) => {
        localStream = stream;
        localVideo.srcObject = stream;
      });

    // Answer incoming calls
    peer.on("call", (call) => {
      call.answer(localStream);
      call.on("stream", (remoteStream) => {
        remoteVideo.srcObject = remoteStream;
      });
    });

    function startCall() {
      const peerId = peerIdInput.value;
      if (!peerId) return alert("Enter Peer ID to call");
      const call = peer.call(peerId, localStream);
      call.on("stream", (remoteStream) => {
        remoteVideo.srcObject = remoteStream;
      });
    }
  </script>
</body>
</html>
