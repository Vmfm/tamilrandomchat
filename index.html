
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow">
    <meta name="audience" content="All" >
    <link rel="icon" href="../images/chatlogo/logo-32-32.png" type="image/gif" sizes="32x32">
    <title>Video chat- free online videochat | IncogChats</title>

    
      <meta name="description" content="Video chat for random people near to you. Talk to strangers with video chat without login and signup.">
    

        

    
    

     <!-- Open Graph / Facebook Meta Tags -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://www.incogchats.com/video-chat-app">
    <meta property="og:title" content="Video chat- free online videochat | IncogChats">
    <meta property="og:description" content="Video chat for random people near to you. Talk to strangers with video chat without login and signup.">
    <meta property="og:image" content="https://www.incogchats.com/images/chatlogo/og-image-1200x630.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="IncogChats">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="http://www.incogchats.com/video-chat-app">
    <meta name="twitter:title" content="Video chat- free online videochat | IncogChats">
    <meta name="twitter:description" content="Video chat for random people near to you. Talk to strangers with video chat without login and signup.">
    <meta name="twitter:image" content="https://www.incogchats.com/images/chatlogo/og-image-1200x630.png">

    <!-- Compiled and minified CSS -->
    <link href="../css/font-css.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="../css/user.css" >
    <link href="../css/material-icons.css" rel="stylesheet">

    <!-- Socket.io file -->
    <!-- <script src="https://www.randomstrangerchats.com/js/socket.io.js"></script> -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

    <!-- Compiled and minified JavaScript -->
    <script src="../js/jquery.min.js"></script>
    <script src="../js/materialize.min.js"></script>

    <script src="../js/user.js"></script>

   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-199197888-1"></script>
   <script>
     window.dataLayer = window.dataLayer || [];
     function gtag(){dataLayer.push(arguments);}
     gtag('js', new Date());

     gtag('config', 'UA-199197888-1');
   </script>


   <!-- Organization Structured data ends -->
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": "IncogChats",
        "url": "https://www.incogchats.com/",
        "logo": "https://www.incogchats.com/images/chatlogo/logo-50-50.png",
        "sameAs":["https://www.facebook.com/incogchats", "https://www.instagram.com/incogchats/"]
      }
      </script>

      <script src="https://www.google.com/recaptcha/api.js" async defer></script>

      <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1695988006776320" crossorigin="anonymous"></script>
      <script async src="https://fundingchoicesmessages.google.com/i/pub-1695988006776320?ers=1" nonce="9y3jLj0MT0oNtsEyoBe3BA"></script>
      <script nonce="9y3jLj0MT0oNtsEyoBe3BA">(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();
      </script>

      
        <!-- Becoz of duplicate content google not approving so, keeping only top pages, google ads -->

      


      <link rel="manifest" href="https://www.incogchats.com/manifest.json">
    
      <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script>
  // Function to check if PWA is installed
  function isPWAInstalled() {
      return (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone);
  }

  // Function to check if the user is logged in
  function isUserLoggedIn() {
      return document.cookie.split(';').some(cookie => cookie.trim().startsWith('ULC=1'));
  }

  // Initialize Firebase only if the user is logged in
  if (isUserLoggedIn()) {
      firebase.initializeApp({
        apiKey: "AIzaSyD-QKvLCSlLFmwypCeuo16cX8gkPxOtBQ8",
        authDomain: "fir-push-notifications-51f84.firebaseapp.com",
        projectId: "fir-push-notifications-51f84",
        storageBucket: "fir-push-notifications-51f84.firebasestorage.app",
        messagingSenderId: "126535850985",
        appId: "1:126535850985:web:e701d2956d3acc25308978"
      });

    }
    
    // Service Worker registration (Only if PWA is installed)
    if (isPWAInstalled() && 'serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js')
            .then((registration) => {
                console.log('Service Worker registered with scope:', registration.scope);
            })
            .catch((err) => {
                console.error('Service Worker registration failed:', err);
            });
    }
</script>


      <script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.format-date').forEach(el => {
    const dateString = el.textContent;
    const date = new Date(dateString);
    if (isNaN(date)) return;
    
    const day = date.getDate();
    const month = date.toLocaleString('default', { month: 'short' });
    const year = date.getFullYear();
    
    const nth = (d) => {
      if (d > 3 && d < 21) return 'th';
      switch (d % 10) {
        case 1: return 'st';
        case 2: return 'nd';
        case 3: return 'rd';
        default: return 'th';
      }
    };
    
    let hours = date.getHours();
    const ampm = hours >= 12 ? 'PM' : 'AM';
    hours = hours % 12;
    hours = hours ? hours : 12;
    const minutes = date.getMinutes().toString().padStart(2, '0');
    
    el.textContent = `${day}${nth(day)} ${month} ${year} ${hours}:${minutes} ${ampm}`;
  });
});
</script>
  </head>

<style>
  /* Header Styles */
  header {
    background-color: var(--panel-header-background);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 20px;
    height: 80px;
  }

  .brand-logo-container {
    display: flex;
    align-items: center;
  }

  .brand-logo {
    display: block;
    font-size: 20px;
    /* font-weight: bold; */
    color: #fff;
    margin-left: 10px;
    text-decoration: none;
  }

  .brand-logo img {
    height: 50px;
    width: 50px;
  }

  .incog-nav {
    list-style: none;
    display: flex;
    gap: 20px;
    margin: 0;
    padding: 0;
    margin-right: 100px;
  }

  .incog-nav li {
    display: flex;
    align-items: center;
  }

  .incog-nav a {
    color: #fff;
    text-decoration: none;
    display: flex;
    align-items: center;
    font-size: 16px;
    font-weight: 500;
  }

  .incog-nav a i {
    margin-right: 8px;
    font-size: 20px;
  }

  .blink_me {
    animation: blinker 1s linear infinite;  
    color: #4CAF50 ;
  }

  @keyframes blinker {
    50% {
      opacity: 0;
    }
  }

  /* Mobile Styles */
  @media (max-width: 600px) {
    header {
    height: 40px;
    }
    .brand-logo-container .brand-logo {
      display: none;
    }
    .brand-logo-img {
      height: 30px !important;
      width: 30px !important;
    }
    .incog-nav {
      gap: 10px;
      font-size: 14px;
      margin: 0;
    }

    .incog-nav span {
      display: none;
    }
  }
</style>

<body>
  <!-- Header -->
  <header>
    <div class="brand-logo-container">
      <img class="brand-logo-img" src="https://www.incogchats.com/images/chatlogo/logo-50-50.png" alt="Best random stranger chat app">
      <a href="/" class="brand-logo">IncogChats</a>
    </div>
    <ul class="incog-nav">
      <li>
        <a href="https://www.incogchats.com/chat-app" title="Stranger chat with random girls and boys">
          <i class="material-icons">chat</i>
          <span>Stranger Text Chat</span>
        </a>
      </li>
      <li>
        <a href="https://www.incogchats.com/video-chat-app" title="Random video chat with people without login">
          <i class="material-icons blink_me">video_call</i>
          <span>Random Video Chat</span>
        </a>
      </li>
    </ul>
  </header>
</body>

<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css"
/>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
/>

<script>
   const API_BASE_URL = 'https://www.randomstrangerchats.com';
   const SOCKET_BASE_URL = 'https://www.randomstrangerchats.com';
  const userName = "Anonymous";
  const userType = "normal";
  const userId = "";
  // const userType = "normal";

  const tokenExpiry = 60 * 60; // 1 hour in seconds (3600)
  const refreshTokenExpiry = 30 * 24 * 60 * 60; // 30 days in seconds (2592000)
  const sameSiteValue = "None";
  const secureFlag = "production" === "production" ? "Secure" : "Secure";
</script>

<style>
  .video-outer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-direction: column;
    height: calc(100vh - 80px);
    overflow: hidden;
  }
  .video-chat-container {
    position: relative;
    width: 100%;
    height: calc(100vh - 80px);
    max-width: 1200px;
    /* border-radius: 15px;
    overflow: hidden;
    background: none; */
  }
  .video-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    background: none;
  }
  .remote-video video {
    width: 100%;
    height: calc(100vh - 80px);
    object-fit: contain;
    display: block;
  }
  .local-video {
    position: absolute;
    bottom: 20px;
    right: 40px;
    width: 180px;
    height: auto;
    background: none;
  }
  .local {
    width: 180px;
    border-radius: 10px;
    border: 2px solid;
  }
  .status {
    position: absolute;
    top: 10px;
    left: 10px;
    background: rgba(255, 0, 0, 0.8);
    color: #fff;
    font-size: 12px;
    font-weight: 700;
    padding: 5px 10px;
    border-radius: 8px;
    z-index: 5;
    letter-spacing: 1px;
  }
  .mobile-status {
    top: 5px;
    left: 5px;
    font-size: 10px;
    font-weight: 700;
    padding: 1px 10px;
    border-radius: 5px;
  }
  .connected-status {
    left: 50%;
    transform: translateX(-50%);
  }
  .down-icons-controls {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    justify-content: space-around;
    align-items: center;
    width: 80%;
    max-width: 450px;
    padding: 10px;
    background-color: #000;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  }
  .video-page-contant {
    margin-top: 400px;
  }
  @media (max-width: 768px) {
    .video-outer {
      height: calc(100vh - 40px);
      flex-direction: column;
      justify-content: space-between;
    }
    .video-chat-container {
      max-width: 100%;
      height: calc(100vh - 40px);
      border-radius: 0;
    }
    .remote-video video {
      max-width: 100%;
      height: calc(100vh - 110px);
      object-fit: cover;
    }
    .local-video {
      top: 10px !important;
      right: 10px;
      width: 60px;
      height: 90px;
    }
    .local {
      width: 60px;
      border: none;
      border-radius: 10px;
    }
    .controls {
      position: fixed;
      bottom: 0;
      z-index: 10;
      background-color: #000;
      border-top: 1px solid #fff;
      padding: 2px;
    }
    #switchCamera {
      display: block;
    }
    #toggleCamera {
      display: none;
    }
    .mobile-status {
      display: none;
    }
    .connected-status {
      top: 5px;
      left: 5px;
      transform: none;
    }
    .down-icons-controls {
      bottom: 0;
      z-index: 10;
      width: 100%;
      padding: 10px;
      background-color: #000;
      border-top: 2px solid gray;
      border-radius: 0;
      box-shadow: none;
    }
    header {
      height: 40px;
      border-bottom: 1px solid gray;
      top: 0;
    }
    .brand-logo-img {
      height: 30px !important;
      width: 30px !important;
    }
    .brand-logo-container .brand-logo {
      display: block;
    }
    .video-page-contant {
      margin-top: 200px;
    }
  }
  @media (min-width: 760px) {
    .local-video {
      position: fixed;
    }
  }

  /* Chat Box */
  .chat-box {
    position: absolute;
    bottom: 200px;
    left: 20px;
    width: 300px;
    height: 300px;
    border-radius: 10px;
    overflow-y: auto;
    padding: 10px;
    z-index: 10;
    color: white;
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }

  .chat-box::-webkit-scrollbar {
    width: 0; /* Chrome, Safari, and Edge */
  }

  .chat-message {
    max-width: 70%;
    padding: 2px 10px;
    border-radius: 10px;
    margin-bottom: 6px;
    word-wrap: break-word;
    position: relative;
    font-size: 14px;
  }

  .chat-message.sent {
    background-color: rgba(0, 123, 255, 0.8);
    color: white;
    margin-left: auto;
    border-bottom-right-radius: 0;
  }

  .chat-message.received {
    background-color: rgba(233, 236, 239, 0.8);
    color: black;
    margin-right: auto;
    border-bottom-left-radius: 0;
  }

  .chat-input-container {
    display: flex;
    align-items: start;
    position: fixed;
    bottom: 85px;
    left: 50%;
    transform: translateX(-50%);
    width: 80%;
    max-width: 450px;
    padding: 5px;
    border-radius: 5px;
  }

  #messageInput {
    flex: 1;
    padding: 2px 10px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 5px 0 0 5px;
    font-size: 15px;
    outline: none;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
  }

  #messageInput:focus {
    border-color: rgba(0, 123, 255, 0.8);
    box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
  }

  .send-icon-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 10.5px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 0 5px 5px 0;
    background-color: rgba(0, 123, 255, 0.8);
    cursor: pointer;
  }

  #sendBtn {
    color: white;
  }

  /* Responsive Chat Box */
  @media (max-width: 720px) {
    .chat-box {
      width: 50%;
      height: 30%;
      bottom: 100px;
      left: 10px;
    }

    .chat-message {
      font-size: 12px;
    }

    .chat-input-container {
      bottom: 65px;
      width: 96%;
    }

    #messageInput {
      width: calc(100% - 80px);
      font-size: 14px;
    }
  }
</style>

<div class="video-outer">
  <div class="video-chat-container">
    <!-- Include various components -->
    <div id="accessRequestModal" class="bg-modal">
  <div class="modal-content">
    <img src="images/allow-access.png" alt="Camera Image" class="allow-access" loading="lazy"/>
    <h5>Allow Webcam and Microphone Access</h5>
    <p>To join the chat, please click the button below to grant access to your webcam and microphone.</p>
    <button id="requestAccess" class="btn btn-large">Use microphone and camera</button>
  </div>
</div>

<div id="accessDeniedModal" class="bg-modal">
  <div class="modal-content">
    <h5>Allow webcam and microphone access</h5>
    <img src="images/request-access.gif" alt="Request Access" loading="lazy"/>
    <p>You can turn them off at any time during the conversation.</p>
    <button id="reload" class="btn hide">Reload the Page</button>
  </div>
</div>

<style>
.bg-modal{display:none;margin:20px auto;justify-content:center;align-items:center;animation:fadeIn .5s ease-in-out}
.modal-content{max-width:650px;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:20px;text-align:center;padding:40px!important;color:#333;animation:slideDown .4s ease}
.modal-content img{width:500px;border-radius:20px}
.allow-access{width:190px!important;height:125px!important}
.modal-content h5{color:#fff}
.modal-content p{color:gray;margin-top:-2px}
.modal-content button{margin-top:10px;font-size:18px;text-transform:capitalize}

@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes slideDown{from{transform:translateY(-30px)}to{transform:translateY(0)}}

@media (max-width:720px){.modal-content{width:96%;max-width:400px}.modal-content img{width:100%}.modal-content button{font-size:16px}}
@media (max-width:420px){.modal-content p,.modal-content button{font-size:14px}}
</style>
 <style>
  .finding-pree-timer{text-align:center;padding:30px 20px;font-family:Arial,sans-serif;font-weight:700!important;color:#ddd}
  .waiting-heading{color:#fff;font-weight:700}
  .fa-spin{font-size:80px;color:#fff;margin:20px 0}
  .status-text{font-size:1rem;margin-top:10px;color:#bbb;opacity:0;animation:fadeInOut 3s infinite}
  @keyframes fadeInOut{0%,100%{opacity:0}50%{opacity:1}}
  @media (max-width:480px){.finding-pree-timer{text-align:center}.waiting-heading{display:none}.fa-spin{font-size:60px}}
</style>


<div class="finding_pree">
  <div class="finding-pree-timer">
    <i class="fa fa-spinner fa-spin"></i>
    <p id="status-text" class="status-text">🌍 Scanning for users...</p>
  </div>

    <ins
      class="adsbygoogle js-ad"
      style="display: block"
      data-ad-client="ca-pub-1695988006776320"
      data-ad-slot="1849987380"
      data-ad-format="auto"
      data-full-width-responsive="true"
    ></ins>
</div>
  
  <script>
    // Array of dynamic messages for the status text
    const messages=["🌍 Scanning for users...","✨ Locating someone for you...","🔄 Almost there, preparing the connection...","🚀 Setting up your session..."];
  
    // Select the status text element
    let i = 0, statusText = document.getElementById("status-text");
  
    // Function to update the status message every 3 seconds
    setInterval(()=>{statusText.textContent=messages[++i%messages.length]},3000);
  </script> <div class="stranger-and-disconnected hide">
  <div class="message-content">
    <h4 id="diconnect-heading">Disconnected⚡</h4>
    <p>Don't worry, just click the 'Next' button to reconnect and keep meeting new people!</p>
  </div>

  <!-- Google Ads -->
  <ins class="adsbygoogle disconnected-message-ads" style="display:block;" data-ad-client="ca-pub-1695988006776320" data-ad-slot="1849987380" data-ad-format="auto" data-full-width-responsive="true"></ins>
</div>

<style>
  .stranger-and-disconnected{width:100%;text-align:center;animation:fadeIn .5s ease}
  .message-content{padding:40px 20px 30px}
  .message-content h4{font-weight:500}
  .message-content p{color:#bbb}
</style>
 <!-- video-chat/components/user-login -->

<style>
    .login-card {
        display: none;
    }
    .card-panel {
    max-width: 450px;
    margin: auto;
    padding: 40px 20px;
    border-radius: 8px;
    background: #2E353B; /* Semi-transparent white background */
    backdrop-filter: blur(10px); /* Blur effect for the background */
    font-size: 16px !important;
    min-height: 300px;
    overflow: visible;
    position: relative;
    z-index: 1;
}
    .card-panel-auth {
        max-width: 450px;
        margin: 40px auto;
        padding: 30px 25px;
        border-radius: 15px;
        color: #333;
        background-color: #ffffff;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
    }

    .card-panel-auth img {
        width: 100px;
        margin-bottom: 20px;
    }

    .google-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        max-width: 300px;
        padding: 15px 20px;
        font-size: 20px;
        border: 1px solid gray;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
        text-transform: uppercase;
        gap: 15px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .google-btn:hover {
        background-color: #2254a4;
        color: white;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .policy {
        width: 300px;
        margin-top: 20px;
        font-size: 12px;
    }

    #additional-details-form {
        display: flex;
        flex-direction: column;
    }
  
</style>

<div id="userLoginModal" class="login-card">
    <div class="card-panel-auth">
        <img src="/images/chatlogo/Logo 150X150.png" alt="IncogChats.club" width="100px" />
        <p>Sign in to IncogChats and start chatting!</p>
        <button class="google-btn" onclick="openGoogleAuth()">
            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0 0 48 48">
                <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path>
                <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path>
                <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path>
                <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path>
            </svg>
            Continue with Google
        </button>
        <p class="policy">
            I confirm that I am at least 18 years old and I agree to the
            <a href="https://www.IncogChats.com/terms-and-conditions" target="_blank">Terms of Service</a> and
            <a href="https://www.IncogChats.com/privacy-policy" target="_blank">Privacy Policy</a>.
        </p>

        <div class="center-align">
            <a href="#" class="grey-text" id="skipGoogleLogin">Skip</a>
        </div>
    </div>
</div>

<!-- Form Section (Rendered Dynamically) -->
<div id="dynamicFormContainer"></div>

<script>
    function openGoogleAuth() {
        const width = 500; // Popup width
        const height = 600; // Popup height
        const left = (window.innerWidth - width) / 2; // Center horizontally
        const top = (window.innerHeight - height) / 2; // Center vertically

        window.open(
            '/login', // Backend authentication route
            'GoogleAuth',
            `width=${width},height=${height},top=${top},left=${left}`
        );
    }

    // Function to initialize Choices.js
    function initializeChoices(selector, options) {
        document.querySelectorAll(selector).forEach((element) => {
            if (!element.classList.contains('choices-initialized')) {
                new Choices(element, options);
                element.classList.add('choices-initialized');
            }
        });
    }

    // MutationObserver to handle dynamically added elements
    const observer = new MutationObserver((mutationsList) => {
        mutationsList.forEach((mutation) => {
            mutation.addedNodes.forEach((node) => {
                if (node.nodeType === 1) { // Ensure it's an element node
                    if (node.matches('#gender, #country') || node.querySelector('#gender, #country')) {
                        initializeChoices('#gender', { searchEnabled: false, itemSelectText: '', shouldSort: false });
                        initializeChoices('#country', { searchEnabled: true, itemSelectText: '', shouldSort: false });
                    }
                }
            });
        });
    });

    // Start observing the document body for changes
    observer.observe(document.body, { childList: true, subtree: true });

    // Initialize Choices.js for existing elements on page load
    document.addEventListener("DOMContentLoaded", function () {
        initializeChoices('#gender', { searchEnabled: false, itemSelectText: '', shouldSort: false });
        initializeChoices('#country', { searchEnabled: true, itemSelectText: '', shouldSort: false });
    });

    window.addEventListener('message', (event) => {
        const { oauth_id, token, action, countries } = event.data;

        if (event.data && event.data.token) {
        document.cookie = `xSessionID=${event.data.token}; path=/; ${secureFlag}; SameSite=${sameSiteValue}; max-age=${tokenExpiry}`;
        document.cookie = `refreshToken=${event.data.refreshToken}; path=/; ${secureFlag}; SameSite=${sameSiteValue}; max-age=${refreshTokenExpiry}`;

        console.log("Token stored in cookies successfully!");
        // window.location.href = "/video-chat-app";
        } else {
        //  console.log("Token not received properly:", event.data);
        }

        if (action === "renderProfile") {
            document.cookie = `ULC=1; max-age=${ 60 * 60}; path=/;`; // ULC = userLoginCompleted, 1 = true (completed)
            window.location.href = '/video-chat-app';
        } else if (action === "renderAdditionalDetails") {
            const userLoginModal = document.getElementById('userLoginModal');
            const safetyModel = document.getElementById('safetyModel');
            userLoginModal.style.display = 'none';

            let countryOptions = '';
            countries.forEach((country) => {
                countryOptions += `<option value="${country.id}">${country.country_name}</option>`;
            });

            document.getElementById('dynamicFormContainer').innerHTML = `
                <div id="userFormModal" class="card-panel">
                    <h3 class="center-align">Join the Fun!</h3>
                    <p class="center-align">Share some details to enhance your chat experience!</p>
                    <form id="additional-details-form">
                        <div class="input-field">
                            <select name="gender" id="gender" required>
                                <option value="" disabled selected>Select Gender</option>
                                <option value="1">👨‍🦱 Male</option>
                                <option value="2">👩‍🦰 Female</option>
                                <option value="3">🌈 Transgender</option>
                                <option value="4">🌀 Other</option>
                            </select>
                        </div>
                        <div class="input-field">
                            <select name="country" id="country" class="chosen-select" required>
                                <option value="" disabled selected>Select Country</option>
                                ${countryOptions}
                            </select>
                        </div>
                        <button type="submit" class="btn btn-large userForm-btn" id="submit">Submit</button>
                    </form>
                </div>
            `;

            // Initialize Choices.js for dropdowns
        let countrySelect = document.getElementById('country');
        let genderSelect = document.getElementById('gender');

        
        const oauthIdInput = document.getElementById('oauthIdInput');
        // const countrySelect = document.querySelector('select[name="country"]');


            // Form submission handler
    const submit = document.getElementById('submit');
    submit.addEventListener('click', function (e) {
        e.preventDefault();

        const gender = genderSelect.value;
        const country = countrySelect.value;
                // Validate inputs
                if (!gender || !country || !oauth_id) {
                    M.toast({ html: 'Please select both gender and country.', classes: 'red' });
                    return;
                }

                // Disable submit button before sending the request
                const submitButton = document.getElementById('submit');
                submitButton.disabled = true;
                submitButton.innerHTML = '<i class="fa fa-spinner fa-spin"></i> Submitting...'; // Add loader

                // Prepare data to send
                const data = {
                    gender,
                    country,
                    oauth_id,
                    website_id: 4
                };

                fetch(`${API_BASE_URL}/api/oauth/additional-details`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                })
                .then(response => response.json())
                .then((result) => {
                    if (result.success) {
                        document.cookie = `ULC=1; max-age=${1 * 60}; path=/;`; // ULC = userLoginCompleted, 1 = true (completed)
                        // alert('Details submitted successfully!');

                        // Hide the form and show the safety modal
                        const userFormModal = document.getElementById('userFormModal');
                        const safetyModel = document.getElementById('safetyModel');

                        if (userFormModal) {
                            userFormModal.style.display = 'none';
                        } else {
                            console.error('Element with id "userFormModal" not found.');
                        }

                        if (safetyModel) {
                            safetyModel.classList.remove('hide');
                        } else {
                            console.error('Element with id "safetyModel" not found.');
                        }
                    } else {
                        alert('Error submitting details: ' + result.message);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('An unexpected error occurred. Please try again.');
                })
                .finally(() => {
                    // Re-enable the button and reset its content
                    submitButton.disabled = false;
                    submitButton.innerHTML = 'Submit';
                });
            });
        }
    });
</script> <!-- video-chat/components/user-form -->
<style>
    #userBasicFormModal{
        display: none;
    }
    .card-panel {
    max-width: 450px;
    margin: auto;
    padding: 20px 40px;
    border-radius: 8px;
    background: #2E353B; /* Semi-transparent white background */
    backdrop-filter: blur(10px); /* Blur effect for the background */
    font-size: 16px !important;
    /* min-height: 300px; */
    overflow: visible;
    position: relative;
    z-index: 1;
}
    .userForm-btn {
        width: 100%;
        margin: 5px 0;
        z-index: 0;
    }
    .user-form-text{
        text-align: center;
        color: white;
    }

    #country{
        z-index: 1;
    }
    .skipStep{
        font-weight: 500;
        margin: 10px auto;
        text-align: center;
    }
    .choices__inner {
        background-color: transparent;
        border: none;
        border-bottom: 1px solid gray;
        padding: 0;
        font-size: 1rem;
        font-weight: 500;
        transition: border-color 0.3s, box-shadow 0.3s;
        text-align: left;
    }

    .choices__list--dropdown {
        /* border-radius: 10px; */
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.15);
        text-align: left;
         color: #000000;  
         z-index: 999;
    }

    button i.fa-spinner {
    vertical-align: middle;
}
</style>

<div id="userBasicFormModal" class="card-panel" >
    <h3 class="user-form-text">Join the Fun!</h3>
    <p class="user-form-text">Share some details to enhance your chat experience, or skip ahead!</p>

    <form action="/register" method="POST" id="registration-form" ">
        <input type="hidden" name="step" id="step" value="1">

        <!-- Step 1 Form -->
        <div id="step-1" class="form-step">
            <div class="input-field">
                <input type="text" name="name" id="name" required >
                <label for="name">Your Name</label>
            </div>

            <div class="input-field">
                <select name="formGender" id="formGender" required>
                    <option value="" disabled selected>Select Gender</option>
                    <option value="1">👨‍🦱 Male</option>
                    <option value="2">👩‍🦰 Female</option>
                    <option value="3">🌈 Transgender</option>
                    <option value="4">🌀 Other</option>
                </select>
            </div>
            <button type="submit" class="btn btn-large userForm-btn" id="firstSubmit" >Submit</button>

            <div class="skipStep">
                <a href="#" class="grey-text" id="skipStep">Skip</a>
            </div>
        </div>

        <!-- Step 2 Form -->
        <div id="step-2" class="form-step" style="display: none;">
            <div class="input-field">
                <input type="email" name="email" id="email">
                <label for="email">Your Email</label>
            </div>

            <div class="input-field">
                <select name="formCountry" id="formCountry" class="chosen-select" required>
                    <option value="" disabled selected>Select Country</option>
                    
                        <option value="55">Afghanistan</option>
                    
                        <option value="99">Albania</option>
                    
                        <option value="1">Algeria</option>
                    
                        <option value="100">Andorra</option>
                    
                        <option value="2">Angola</option>
                    
                        <option value="146">Antigua and Barbuda</option>
                    
                        <option value="183">Argentina</option>
                    
                        <option value="101">Armenia</option>
                    
                        <option value="169">Australia</option>
                    
                        <option value="102">Austria</option>
                    
                        <option value="103">Azerbaijan</option>
                    
                        <option value="147">Bahamas</option>
                    
                        <option value="56">Bahrain</option>
                    
                        <option value="57">Bangladesh</option>
                    
                        <option value="148">Barbados</option>
                    
                        <option value="104">Belarus</option>
                    
                        <option value="105">Belgium</option>
                    
                        <option value="149">Belize</option>
                    
                        <option value="3">Benin</option>
                    
                        <option value="201">Bermuda</option>
                    
                        <option value="58">Bhutan</option>
                    
                        <option value="184">Bolivia</option>
                    
                        <option value="106">Bosnia and Herzegovina</option>
                    
                        <option value="4">Botswana</option>
                    
                        <option value="185">Brazil</option>
                    
                        <option value="59">Brunei</option>
                    
                        <option value="107">Bulgaria</option>
                    
                        <option value="5">Burkina</option>
                    
                        <option value="60">Burma (Myanmar)</option>
                    
                        <option value="6">Burundi</option>
                    
                        <option value="61">Cambodia</option>
                    
                        <option value="7">Cameroon</option>
                    
                        <option value="150">Canada</option>
                    
                        <option value="8">Cape Verde</option>
                    
                        <option value="9">Central African Republic</option>
                    
                        <option value="10">Chad</option>
                    
                        <option value="186">Chile</option>
                    
                        <option value="62">China</option>
                    
                        <option value="187">Colombia</option>
                    
                        <option value="11">Comoros</option>
                    
                        <option value="12">Congo</option>
                    
                        <option value="151">Costa Rica</option>
                    
                        <option value="108">Croatia</option>
                    
                        <option value="152">Cuba</option>
                    
                        <option value="199">Curacao</option>
                    
                        <option value="109">Cyprus</option>
                    
                        <option value="110">Czech Republic</option>
                    
                        <option value="111">Denmark</option>
                    
                        <option value="14">Djibouti</option>
                    
                        <option value="153">Dominica</option>
                    
                        <option value="63">East Timor</option>
                    
                        <option value="188">Ecuador</option>
                    
                        <option value="15">Egypt</option>
                    
                        <option value="155">El Salvador</option>
                    
                        <option value="16">Equatorial Guinea</option>
                    
                        <option value="17">Eritrea</option>
                    
                        <option value="112">Estonia</option>
                    
                        <option value="18">Ethiopia</option>
                    
                        <option value="170">Fiji</option>
                    
                        <option value="113">Finland</option>
                    
                        <option value="114">France</option>
                    
                        <option value="19">Gabon</option>
                    
                        <option value="20">Gambia</option>
                    
                        <option value="115">Georgia</option>
                    
                        <option value="116">Germany</option>
                    
                        <option value="21">Ghana</option>
                    
                        <option value="117">Greece</option>
                    
                        <option value="156">Grenada</option>
                    
                        <option value="157">Guatemala</option>
                    
                        <option value="22">Guinea</option>
                    
                        <option value="23">Guinea-Bissau</option>
                    
                        <option value="189">Guyana</option>
                    
                        <option value="158">Haiti</option>
                    
                        <option value="159">Honduras</option>
                    
                        <option value="196">Hong Kong</option>
                    
                        <option value="118">Hungary</option>
                    
                        <option value="119">Iceland</option>
                    
                        <option value="64">India</option>
                    
                        <option value="65">Indonesia</option>
                    
                        <option value="66">Iran</option>
                    
                        <option value="67">Iraq</option>
                    
                        <option value="120">Ireland</option>
                    
                        <option value="68">Israel</option>
                    
                        <option value="121">Italy</option>
                    
                        <option value="24">Ivory Coast</option>
                    
                        <option value="160">Jamaica</option>
                    
                        <option value="69">Japan</option>
                    
                        <option value="70">Jordan</option>
                    
                        <option value="71">Kazakhstan</option>
                    
                        <option value="25">Kenya</option>
                    
                        <option value="171">Kiribati</option>
                    
                        <option value="72">Korea, North</option>
                    
                        <option value="73">Korea, South</option>
                    
                        <option value="197">Kosovo</option>
                    
                        <option value="74">Kuwait</option>
                    
                        <option value="75">Kyrgyzstan</option>
                    
                        <option value="76">Laos</option>
                    
                        <option value="122">Latvia</option>
                    
                        <option value="77">Lebanon</option>
                    
                        <option value="26">Lesotho</option>
                    
                        <option value="27">Liberia</option>
                    
                        <option value="28">Libya</option>
                    
                        <option value="123">Liechtenstein</option>
                    
                        <option value="124">Lithuania</option>
                    
                        <option value="125">Luxembourg</option>
                    
                        <option value="126">Macedonia</option>
                    
                        <option value="29">Madagascar</option>
                    
                        <option value="30">Malawi</option>
                    
                        <option value="78">Malaysia</option>
                    
                        <option value="79">Maldives</option>
                    
                        <option value="31">Mali</option>
                    
                        <option value="127">Malta</option>
                    
                        <option value="172">Marshall Islands</option>
                    
                        <option value="32">Mauritania</option>
                    
                        <option value="33">Mauritius</option>
                    
                        <option value="161">Mexico</option>
                    
                        <option value="173">Micronesia</option>
                    
                        <option value="128">Moldova</option>
                    
                        <option value="129">Monaco</option>
                    
                        <option value="80">Mongolia</option>
                    
                        <option value="130">Montenegro</option>
                    
                        <option value="34">Morocco</option>
                    
                        <option value="35">Mozambique</option>
                    
                        <option value="36">Namibia</option>
                    
                        <option value="174">Nauru</option>
                    
                        <option value="81">Nepal</option>
                    
                        <option value="131">Netherlands</option>
                    
                        <option value="175">New Zealand</option>
                    
                        <option value="162">Nicaragua</option>
                    
                        <option value="37">Niger</option>
                    
                        <option value="38">Nigeria</option>
                    
                        <option value="132">Norway</option>
                    
                        <option value="82">Oman</option>
                    
                        <option value="83">Pakistan</option>
                    
                        <option value="176">Palau</option>
                    
                        <option value="200">Palestinian Territory</option>
                    
                        <option value="163">Panama</option>
                    
                        <option value="177">Papua New Guinea</option>
                    
                        <option value="190">Paraguay</option>
                    
                        <option value="191">Peru</option>
                    
                        <option value="84">Philippines</option>
                    
                        <option value="133">Poland</option>
                    
                        <option value="134">Portugal</option>
                    
                        <option value="202">Puerto Rico</option>
                    
                        <option value="85">Qatar</option>
                    
                        <option value="135">Romania</option>
                    
                        <option value="86">Russian Federation</option>
                    
                        <option value="39">Rwanda</option>
                    
                        <option value="164">Saint Kitts and Nevis</option>
                    
                        <option value="165">Saint Lucia</option>
                    
                        <option value="166">Saint Vincent and the Grenadines</option>
                    
                        <option value="178">Samoa</option>
                    
                        <option value="136">San Marino</option>
                    
                        <option value="40">Sao Tome and Principe</option>
                    
                        <option value="87">Saudi Arabia</option>
                    
                        <option value="41">Senegal</option>
                    
                        <option value="137">Serbia</option>
                    
                        <option value="42">Seychelles</option>
                    
                        <option value="43">Sierra Leone</option>
                    
                        <option value="88">Singapore</option>
                    
                        <option value="138">Slovakia</option>
                    
                        <option value="139">Slovenia</option>
                    
                        <option value="179">Solomon Islands</option>
                    
                        <option value="44">Somalia</option>
                    
                        <option value="45">South Africa</option>
                    
                        <option value="46">South Sudan</option>
                    
                        <option value="140">Spain</option>
                    
                        <option value="89">Sri Lanka</option>
                    
                        <option value="47">Sudan</option>
                    
                        <option value="192">Suriname</option>
                    
                        <option value="48">Swaziland</option>
                    
                        <option value="141">Sweden</option>
                    
                        <option value="142">Switzerland</option>
                    
                        <option value="90">Syria</option>
                    
                        <option value="195">Taiwan</option>
                    
                        <option value="91">Tajikistan</option>
                    
                        <option value="49">Tanzania</option>
                    
                        <option value="92">Thailand</option>
                    
                        <option value="50">Togo</option>
                    
                        <option value="180">Tonga</option>
                    
                        <option value="167">Trinidad and Tobago</option>
                    
                        <option value="51">Tunisia</option>
                    
                        <option value="93">Turkey</option>
                    
                        <option value="94">Turkmenistan</option>
                    
                        <option value="181">Tuvalu</option>
                    
                        <option value="52">Uganda</option>
                    
                        <option value="143">Ukraine</option>
                    
                        <option value="95">United Arab Emirates</option>
                    
                        <option value="144">United Kingdom</option>
                    
                        <option value="193">Uruguay</option>
                    
                        <option value="168">USA</option>
                    
                        <option value="96">Uzbekistan</option>
                    
                        <option value="182">Vanuatu</option>
                    
                        <option value="145">Vatican City</option>
                    
                        <option value="194">Venezuela</option>
                    
                        <option value="97">Vietnam</option>
                    
                        <option value="98">Yemen</option>
                    
                        <option value="53">Zambia</option>
                    
                        <option value="54">Zimbabwe</option>
                    
                </select>
                <!-- <label for="country">Country</label> -->
            </div>

            <button type="submit" class="btn btn-large userForm-btn" id="submit">Submit</button>
            <div class="center-align">
                <a href="#" class="grey-text" id="skipToSuccess">Skip</a>
            </div>
        </div>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // const countrySelect = document.querySelector('select[name="country"]');
        const formCountrySelect =document.getElementById('formCountry');

        const form = document.getElementById('registration-form');
        const step1 = document.getElementById('step-1');
        const step2 = document.getElementById('step-2');
        const skipStepBtn = document.getElementById('skipStep');
        const stepInput = document.getElementById('step');
        // const genderSelect = document.querySelector('select[name="gender"]');
        const formGenderSelect =document.getElementById('formGender');

          // Initialize Choices.js on country select
        if (formGenderSelect) {
                new Choices(formGenderSelect, {
                    searchEnabled: false, // Enables the search feature
                    itemSelectText: '',
                    shouldSort: false
                });
            }
        // Initialize Choices.js on country select
        if (formCountrySelect) {
                new Choices(formCountrySelect, {
                    searchEnabled: true, // Enables the search feature
                    itemSelectText: '',
                    shouldSort: false
                });
            }

        // Move to Step 2 when gender is selected
        formGenderSelect.addEventListener('change', function () {
           // If validation passes, go to Step 2
            skipStepBtn.style.display = 'none';
            document.getElementById('firstSubmit').style.display = 'none';
            step2.style.display = 'block';
            stepInput.value = "2"; // Update hidden input value for step
        });

        // Validate form submission
        const firstSubmit = document.getElementById('firstSubmit');
        firstSubmit.addEventListener('click', function (e) {
            const nameInput = document.getElementById('name');

            // Check if the name input has a value
            if (nameInput.value.trim() === '') {
                M.toast({html: 'Please enter your name.', classes: 'red'}); // Show a toast notification
                formGenderSelect.selectedIndex = 0; // Reset gender selection
                return; // Prevent moving to the next step
            }
            if (!formGenderSelect.value) {              
                M.toast({html: 'Please select your gender.', classes: 'red'}); // Show a toast notification
                e.preventDefault(); // Prevent form submission if invalid
                return;
            }
        });
        // Validate form submission
        const submit = document.getElementById('submit');
        submit.addEventListener('click', function (e) {
            // const nameInput = document.getElementById('name');
            e.preventDefault();

            const name = document.getElementById('name').value.trim();
            const gender = formGenderSelect.value;
            const email = document.getElementById('email').value.trim();
            const country = formCountrySelect.value;

            // Validate inputs
            if (!name || !gender || !country) {
                M.toast({ html: 'Please complete all required fields.', classes: 'red' });
                return;
            }
           
             // Disable submit button before sending the request
            submit.disabled = true;
            submit.innerHTML = '<i class="fa fa-spinner fa-spin fa-sm"></i> Submitting...'; // Add loader

             // Prepare data to send
             const data = {
                name,
                gender,
                email: email || null, // Optional field
                country,
                website_id: 4 // Replace this with the actual website_id
            };

            // Post data to the API
            fetch(`${API_BASE_URL}/api/register`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => response.json())
                .then(result => {
                    const submitButton = document.getElementById('submit');
                    if (result.success) {
                
                         // Set cookies based on response
                        document.cookie = `BFC=1; max-age=${30 * 24 * 60 * 60}; path=/;`;
                        document.cookie = `user_id=${result.user_id}; max-age=${30 * 24 * 60 * 60}; path=/; `;
                        // console.log("textt:", result.user_id)
                         // Show success message
                        M.toast({ html: result.message || 'Registration successful!', classes: 'green' });
                         // Redirect to video chat app
                        // Wait for 2 seconds before redirecting
                        setTimeout(() => {
                            window.location.href = '/video-chat-app';
                        }, 2000);                    
                    } else {
                        M.toast({ html: result.message || 'Registration failed.', classes: 'red' });
                        submit.disabled = false;
                        submit.innerHTML = 'Submit'; // Reset button text
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    M.toast({ html: 'Something went wrong. Please try again.', classes: 'red' });
                    submit.disabled = false;
                    submit.innerHTML = 'Submit'; // Reset button text
                });

        });
    });
</script>
 <style>
    .safty-modal-container{display:flex;justify-content:center;align-items:center;font-family:Poppins,sans-serif}
    .safty-modal{background:#fff;padding:20px;border-radius:12px;width:100%;max-width:450px;box-shadow:0 10px 30px rgba(0,0,0,.1);z-index:1000;overflow:hidden}
    .safty-modal h1{font-size:1.5rem;color:#2c3e50;font-weight:600;margin-bottom:5px;text-align:center}
    p{font-size:14px;color:#7f8c8d;text-align:center}
    .safty-modal ul{list-style:none;padding:0;margin:20px 0;text-align:left}
    .safty-modal li{font-size:.9rem;padding:10px;background:#f1f2f6;margin:12px 0;border:1px solid #e9e8e8;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,.1);display:flex;align-items:center;gap:10px}
    .safty-modal li strong{font-weight:500;flex:1;color:#34495e}
    .safty-modal li p{font-size:.8rem;flex:1;color:#95a5a6;text-align:left}
    .safty-modal li span{font-size:1.5rem;flex-shrink:0;color:#e74c3c}
    .safty-modal button{background:#3498db;color:#fff;padding:12px 30px;margin-top:20px;border:none;border-radius:30px;font-size:1.2rem;cursor:pointer;font-weight:600;transition:.3s;display:block;margin-left:auto}
    .safty-modal button:hover{background:#2980b9}
    a{color:#3498db;text-decoration:none;font-weight:500}
    a:hover{text-decoration:underline}
    @media (max-width:600px){.safty-modal{width:95%;padding:15px}
    .safty-modal h1{font-size:1.2rem}
    .safty-modal li{font-size:.8rem;padding:8px}
    .safty-modal li span{font-size:1.2rem}
    .safty-modal button{padding:10px 20px;font-size:1rem}}
    </style>
    <div class="safty-modal-container hide" id="safetyModel">
      <div class="safty-modal">
        <h1>Community Safety Rules</h1>
        <p>Please take a moment to read our rules to avoid getting banned and to help us keep the community safe.</p>
        <ul>
          <li><span>🚫</span><div><strong>No nudity, sexual, or inappropriate behavior</strong><p>Realtime AI and human moderation is active</p></div></li>
          <li><span>🔞</span><div><strong>18+ only</strong><p>Don't show anyone under 18 years old</p></div></li>
          <li><span>👤</span><div><strong>Keep your face visible</strong><p>Avoid streaming irrelevant content</p></div></li>
          <li><span>⚠️</span><div><strong>Report inappropriate content</strong><p>Help us keep the community safe</p></div></li>
        </ul>
        <p>Make sure to read our full <a href="/community-guidelines" target="_blank">Community Guidelines</a></p>
        <button onclick="closeModal()">Understood</button>
      </div>
    </div>
    <script>
    function closeModal(){window.location.href='/video-chat-app'}
    </script>
    

    <!-- Remote Video Stream -->
    <div class="video-wrapper remote-video">
      <span class="status connected-status hide">CONNECTED</span>
      <video class="remote" autoplay playsinline></video>

      <!-- Sticker Overlay Container -->
      <div id="stickerOverlay" class="sticker-overlay"></div>

      <!-- Chat Box -->
      <div id="chatBox" class="chat-box"></div>
    </div>

    <!-- Local Video Stream -->
    <div class="video-wrapper local-video" id="local-video">
      <span class="status mobile-status">LIVE</span>
      <video class="local" autoplay muted playsinline></video>
    </div>

    <!-- Sticker Picker Modal -->
    <div id="stickerPickerModal" class="sticker-modal hide">
      <div class="sticker-modal-content">
        <span class="close-modal">&times;</span>
        <div class="sticker-grid">
          <!-- Stickers will be dynamically added here -->
        </div>
      </div>
    </div>

    <!-- Chat Input Container -->
    <div id="textMessageOptions" class="chat-input-container hidden">
      <input type="text" id="messageInput" placeholder="Type your message..." />
      <button class="send-icon-btn">
        <i id="sendBtn" class="material-icons">send</i>
      </button>
    </div>

    <!-- Control Icons -->
    <style>
  .down-icon-btn,
  .down-icon-btn-next {
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    cursor: pointer;
    text-align: center;
    margin: 0 auto;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    color: #fff;
    letter-spacing: 2px;
  }
  .down-icon-btn {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: #272728;
    padding: 12px;
  }
  .down-icon-btn:hover {
    background-color: #2d2d2d;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  #settingsOptions {
  position: fixed;
  bottom: 85px;
  right: 27%;
  gap: 10px;
}

.setting-down-icon-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  border: 1px solid rgb(61, 61, 61);
  background-color: #363639;
  color: white;
  padding: 12px;
  cursor: pointer;
}
.setting-down-icon-btn:hover {
  background-color: #2d2d2d;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

#settingsOptions:not(.hidden) {
  display: flex;
}

  .material-icons {
    font-size: 28px;
  }
  .down-icon-btn-next {
    background: transparent;
    border: 2px solid #fff;
    border-radius: 8px;
    padding: 12px;
    font-size: 18px;
    font-weight: 500;
    width: 120px;
  }
  .down-icon-btn-next.next {
    background: rgba(255, 0, 0, 0.8);
    transition: background-color 0.3s ease, transform 0.3s ease;
  }
  .down-icon-btn-next.next.disabled {
    background-color: #145373;
  }
  .down-icon-btn-next.next.disabled:hover {
    transform: scale(1.1);
  }
/* Switch Camera Button for Mobile */
.setting-down-icon-btn.switch-camera {
  display: none;
}

.hidden {
  display: none;
}

/* Sticker Grid Styling */
.sticker-grid {
  display: grid;
  position: fixed;
  bottom: 80px;
  left: 50%;
  transform: translateX(-50%);
  grid-template-columns: repeat(10, 1fr);
  gap: 10px;
  padding: 10px;
  z-index: 1000;
}

.sticker-item {
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 34px;
  cursor: pointer;
  transition: transform 0.2s ease, background-color 0.2s ease;
}

.sticker-item:hover {
  transform: scale(1.1);
  background-color: #e0e0e0;
}

@keyframes floatUp {
  0% {
    transform: translateY(-10vh);
    opacity: 1;
  }
  100% {
    transform: translateY(-100vh);
    opacity: 0;
  }
}

.sticker {
  position: absolute;
  font-size: 48px;
  left: 0;
  bottom: 0;
  animation: floatUp 5s linear forwards;
  pointer-events: none;
}

.sticker-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
  z-index: 100;
}

/* Responsive Styles */
@media (max-width: 470px) {
  .down-icon-btn, .setting-down-icon-btn {
    width: 50px;
    height: 50px;
  }

  .material-icons {
    font-size: 24px;
  }

  .setting-down-icon-btn.switch-camera {
    display: inline-flex;
  }

  #toggleCameraButton {
    display: none !important;
  }

  .sticker-grid {
    bottom: 70px;
    grid-template-columns: repeat(5, 1fr);
    gap: 5px;
  }

  .sticker-item {
    font-size: 24px;
    padding: 8px;
  }

  .send-icon-btn {
    padding: 11px;
  }
}
</style>

<div class="down-icons-controls" id="down-icons-flex">
  <button id="textMessageButton" class="down-icon-btn">
    <i class="material-icons">chat</i>
  </button>

  <div id="settingsOptions" class="hidden">
    <button id="toggleMicrophoneButton" class="setting-down-icon-btn">
      <i id="toggleMicrophone" class="material-icons">mic</i>
    </button>
    <button id="toggleCameraButton" class="setting-down-icon-btn">
      <i id="toggleCamera" class="material-icons">videocam</i>
    </button>
    <button id="toggleSpeakerButton" class="setting-down-icon-btn">
      <i id="toggleSpeaker" class="material-icons">volume_up</i>
    </button>
    <button class="setting-down-icon-btn switch-camera">
      <i id="switchCamera" class="material-icons">flip_camera_ios</i>
    </button>
  </div>

  <button id="stickerPickerButton" class="down-icon-btn">
    <i class="material-icons">insert_emoticon</i>
  </button>

  <button id="settingsButton" class="down-icon-btn">
    <i class="material-icons">settings</i>
  </button>
  <button class="down-icon-btn-next next disabled">Next</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.9.6/lottie.min.js"></script>
<script>
  const settingsOptions = document.getElementById("settingsOptions");
 const textMessageOptions = document.getElementById("textMessageOptions");
 const stickerPickerModal = document.getElementById("stickerPickerModal");
 
 // Function to close all modals except the one passed as an argument
 function closeAll(except = null) {
   if (except !== settingsOptions) settingsOptions.classList.add("hidden");
   if (except !== textMessageOptions) textMessageOptions.classList.add("hidden");
   if (except !== stickerPickerModal) stickerPickerModal.style.display = "none";
 }
 
 // Event listeners for buttons
 document.getElementById("settingsButton").addEventListener("click", () => {
   const isCurrentlyOpen = !settingsOptions.classList.contains("hidden");
   closeAll();
   if (!isCurrentlyOpen) settingsOptions.classList.remove("hidden");
 });
 
 document.getElementById("textMessageButton").addEventListener("click", () => {
   const isCurrentlyOpen = !textMessageOptions.classList.contains("hidden");
   closeAll();
   if (!isCurrentlyOpen) textMessageOptions.classList.remove("hidden");
 });
 
 document.getElementById("stickerPickerButton").addEventListener("click", () => {
   const isCurrentlyOpen = stickerPickerModal.style.display === "block";
   closeAll();
   if (!isCurrentlyOpen) stickerPickerModal.style.display = "block";
 });
 
 // Close sticker modal when clicking outside
 window.addEventListener("click", (event) => {
   if (event.target === stickerPickerModal) {
     stickerPickerModal.style.display = "none";
   }
 });
 
 // Close sticker modal on button click
 stickerPickerModal.querySelector(".close-modal").addEventListener("click", () => {
   stickerPickerModal.style.display = "none";
 });
 
 // Load stickers into the grid
 const stickerGrid = stickerPickerModal.querySelector(".sticker-grid");
 const stickers = [
  { text: "😀", file: `${API_BASE_URL}/stickers/happy.json` },
  { text: "😂", file: `${API_BASE_URL}/stickers/laughing.json` },
  { text: "😍", file: `${API_BASE_URL}/stickers/love.json` },
  { text: "🤔", file: `${API_BASE_URL}/stickers/thinking.json` },
  { text: "😎", file: `${API_BASE_URL}/stickers/cool.json` },
  { text: "🥳", file: `${API_BASE_URL}/stickers/celebration.json` },
  { text: "😡", file: `${API_BASE_URL}/stickers/angry.json` },
  // { text: "😢", file: `${API_BASE_URL}/stickers/sad.json` },
  { text: "👍", file: `${API_BASE_URL}/stickers/thumbsup.json` },
  { text: "👏", file: `${API_BASE_URL}/stickers/clap.json` },
  { text: "❤️", file: `${API_BASE_URL}/stickers/heart.json` },
];
 
stickers.forEach(sticker => {
  const stickerElement = document.createElement("span");
  // stickerElement.textContent = sticker;
  stickerElement.textContent = sticker.text; // Display the text emoji
  stickerElement.style.fontSize = "25px";
  stickerElement.style.cursor = "pointer";
  stickerElement.addEventListener("click", () => {
    // sendSticker(sticker);
    sendSticker(sticker.file); // Send the Lottie file link
    stickerPickerModal.style.display = "none";
  });
  stickerGrid.appendChild(stickerElement);
});
 </script>

  </div>
</div>

<div class="grey-text small col s12 video-page-contant">
  <p>
    Having random video chats with girls and women from any place in the world
    is so much fun. When your friend is visible you can start a random chat with
    girls and strangers. Chat with random people specially girls and teens on a
    video alternative chat whenever you want.
  </p>
  <p>
    Free chat with girls on random video chat where you can fulfill your desire
    of random chat and talk on random topics of your choice. In free chat rooms
    on a video alternative chat you will get so many beautiful girls who are
    ready to talk to you. The fascinating random video chat with random people
    is so cool. Talk to strangers on video alternative chat in random chat with
    strangers to entertain yourself now.
  </p>
  <p>
    No one can resist a hot chat with beautiful girls from Bhutan ever, so you
    don't need to wait anymore. Start your random chat with amazing girls now.
    Free chat with girls from around the world. Be friends with anonymous girls
    and teens or date and impress them. It's up to you. Lots of random girls
    from different are waiting for you to initiate a conversation on a free
    online chat. You just need to start a Live chat and start random chat with
    girls in free chat rooms. Random video chat with girls is so spicy.
  </p>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-messaging-compat.js"></script>
<script>
  if (firebase.apps.length > 0) {
      const messaging = firebase.messaging();

      // Function to check if PWA is installed
      function isPWAInstalled() {
          return (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone);
      }

      // Request permission and get token (Only in PWA mode)
      if (isPWAInstalled()) {
          Notification.requestPermission().then((permission) => {
              if (permission === 'granted') {
                  console.log('Notification permission granted.');
                  return messaging.getToken({ vapidKey: 'BBTNf6oXbBAzGf0EakizZpMs49VrQmqpOMzjV_nLB_BSK_ZOw0h-oRazj-iYNbUBtdz-eLx6O570-HWYINxTcLY' });
              } else {
                  throw new Error('Notification permission not granted');
              }
          })
          .then((token) => {
            //   console.log('FCM Token:', token);
            //   console.log('userId:', userId);
              // Send token to server
              fetch('https://www.randomstrangerchats.com/api/register-token', {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify({ token: token, websiteId: 4, userId })
              })
              .then(res => res.json())
              .then(data => console.log('Token registered successfully:', data))
              .catch(err => console.error('Error registering token:', err));
          })
          .catch((err) => {
              console.error('Unable to get permission or token:', err);
          });

          // Handle foreground messages
          messaging.onMessage((payload) => {
              console.log('Message received in foreground:', payload);
          });
      } else {
          console.log("PWA is not installed. Firebase notifications are disabled.");
      }
  }
</script>


<script src="https://www.randomstrangerchats.com/js/materialize.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<script src="https://www.randomstrangerchats.com/js/simple-peer.js"></script>
<script src="../js/video-chat.js"></script>

<script>
  window.onload = function () {
    if (window.adsbygoogle) {
      (adsbygoogle = window.adsbygoogle || []).push({});
    }
  };
</script>
